# 使用マニュアル


### 初期設定
py/settings/settings_coreを編集することにより初期設定を完了します．基本的にPY_DIR_PATHとCWD_PATHを設定のみで問題ないです．

### 使用する際の規定
以下のルールを守らなければ，バグの原因になります．必ず以下の規定を守るようにしてください．
  - フォルダ名や変数名は必ず半角小文字，アルファベットか数字にしてください．
  - ansysのコマンドを記録するファイルの拡張子は".ansys"とします．
  - 結果ファイルを格納するファイルは”.csv"とします．
  - ".ansys"および，".csv"ファイルは全て名前がルール通りに変更されてしまうため，それらの拡張子で名前を変更したくないファイルがある場合は，settings_core.pyのOMISSIONへ追加してください．



## ファイルの自動生成 ・ ファイル名の更新 ~ files_management.py ~
ansysファイル(csvファイル)を複数自動生成します．さらに，ansysファイルの物性値や形状などのパラメータを複数確認したい場合は各パラメータの数だけファイルを複数自動生成し，フォルダごとに分けます．
また，指定拡張子のファイル名を以下のルールに従って自動生成します．

### 使用手順
  1. 特定フォルダにbase.ansysを作成します．
  2. base.ansys内にはansysのコマンドを保存しますが，必ず解析実行の"SOLVE"直前までのコマンドまでにしてください．"SOLVE"およびそれ以降のコマンドは削除してください．
  3. パラメータを変化させたい場合は，base.ansysの変更させたい部分に{% 変数 %}という表記方法で表記します．「変数」の部分にわかりやすい変数を書きます．　（例）{% thickness %}
  4. settings_child.pyのDIR_STRUCTUREに記載方法に乗っとてbase.ansysのある相対パスをと上記の変数，パラメータの数値（リスト形式）を書き込みます．
  5. コマンドプロンプトでansys-managementディレクトリへ移動し，`ipython ansys_management.py`と打ち込み，実行します．
  6. "1: ファイルの自動生成"を選択します，

### ファイル名ルール
  - フォルダ名の省略文字を繋げて作成する．
  - py/settings/abbreviation.pyのABBREVIATIONで設定された省略名を元にする．
  - ABBREVIATIONに名前が含まれていない場合，頭文字3文字をつなげる．

### 例
cfrp2_lap=10/thickness=2.0/gap=2.0/ にあるansysファイル   →   c2_l10_th2.0_g2.0.ansys

  - c2_l10 ： cfrp2_lap=10
  - th2.0 ： thickness=2.0
  - g2.0 ： gap=2.0

### エラー発生原因の可能性
"ファイルの自動生成"を実行して，pythonエラーが発生した場合，以下の可能性があります．また，エラーの原因が以下にリストアップされていない可能性があります．
  - base.ansysが設置されていない．
  - base.ansys内の{% 変数 %}の変数がsettings_child.pyのDIR_STRUCTUREに記載されていない．


## 自動解析 ~ auto_analysis.py ~
本ライブラリでは，ansysコマンド格納ファイル(.ansys)を元に，複数個の解析を一気に解析することができる．本ライブラリを用いいることで大幅に解析時間を短縮することができます．

### 使用手順
  1. settings_child.pyのANALYSIS_PATHには相対パスを記入します．そのパス以降にあるansysファイルを全て解析します．
  2. 指定するパスが複数ある場合，そのパスをリスト形式で書きます．
  3. コマンドプロンプトでansys-managementディレクトリへ移動し，`ipython ansys_management.py`と打ち込み，実行します．
  4. "2: 自動解析"を実行します．
  5. csvへ結果を出力するか選択します．
  6. csvへ出力する場合は試験片の断面積を記入します．単位は㎟
  7. 解析するファイルがリストアップされるため，よく確認し，実行します．
  8. 解析終了後，csvへ時間と荷重が出力．またそれから得られる応力ひずみ線図をまとめたエクセルファイルが出力されます．

### エラー発生原因の可能性
"自動解析"を実行して，pythonエラーが発生した場合，以下の可能性があります．また，エラーの原因が以下にリストアップされていない可能性があります．
  - パソコンのハードディスク容量がいっぱいになってしまっている．



## 応力ひずみ線図ファイルの作成 ~ make_stress_strain.py ~
本ライブラリでは，時間と荷重をひずみと応力に変換し，エクセルに結果を格納します．従って，応力ひずみ線図を使用する必要がない場合，本ライブラリを使用する意味はありません．

### 使用方法
応力ひずみ線図をまとめたエクセルファイルの作成方法は２つあります．２つめがpath.xlsxを用いる方法．２つ目が，settings_child.pyのANALYSIS_PATHでパスを指定する方法です．
#### path.xlsx
一度にまとめる解析結果は，全て引張速度・試験片長さ・断面積が同じ解析モデルでなければなりません．
  1. csvファイルに解析結果が含まれることを確認します．
  2. path.xlsxを開き，初期パス・出力ファイル名・プラスかマイナス・引張速度・試験片長さ・断面積を入力します．
  3. コマンドプロンプトでansys-managementディレクトリへ移動し，`ipython ansys_management.py`と打ち込み，実行します．
  4. "0: path.xlsx"を選択します．
  5. "2: 応力ひずみ線図の作成"を選択します．
  6. 出力したいファイルを選択します．
#### settings_child.ANALYSIS_PATH
一度にまとめる解析結果は，全て断面積が同じ解析モデルでなければなりません．
  1. csvファイルに解析結果が含まれることを確認します．
  2. settings_child.pyのDISTANCE・TIME・LENGTHの変数が一致していることを確認します．
  3. コマンドプロンプトでansys-managementディレクトリへ移動し，`ipython ansys_management.py`と打ち込み，実行します．
  4. "3: 応力ひずみ線図の作成"を選択します．
  5. "1: settings_child.ANSYS_PATH"を選択します．
